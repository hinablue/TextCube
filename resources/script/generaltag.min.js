function tcTagFunction_WatchInputBox(id){try{var instance=document.getElementById(id).instance;var input=instance.getInput();if(input.value.charAt(input.value.length-1)==','){if(input.value.length==1)input.value='';else instance.setValue(input.value.substring(0,input.value.length-1));return}if(input.value!=instance.typingText){instance.typingText=input.value;instance.requestSuggestion()}}catch(e){}}function tcTagFunction_showLocalSuggestion(id,cursor,filter){try{var instance=document.getElementById(id).instance}catch(e){return}if(instance.cursor!=cursor||!instance.isTyping)return;var input=instance.getInput();var xmlhttp=createHttp();if(xmlhttp){xmlhttp.open("GET",blogURL+"/suggest/?id="+id+"&cursor="+cursor+"&filter="+(STD.isSafari?filter:encodeURIComponent(filter)),true);xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){try{var doc=xmlhttp.responseXML;var root=doc.getElementsByTagName("response")[0];var id=root.getAttribute("id");var cursor=root.getAttribute("cursor");var instance=document.getElementById(id).instance;if(instance.cursor==cursor){var tags=new Array();var tagItems=root.getElementsByTagName("tag");if(!instance.allowEolinSuggestion&&tagItems.length==0){instance.hideSuggestion();return}for(var i=0;i<tagItems.length;i++)tags[tags.length]=tagItems[i].lastChild.nodeValue;for(var i=0;i<tags.length;i++){for(var j=0;j<instance.suggestion.childNodes.length;j++){if(tags[i]==instance.suggestion.childNodes[j].innerHTML.replace(new RegExp("<\/?strong>","gi"),"")){instance.suggestion.removeChild(instance.suggestion.childNodes[j]);break}}}var htmlText=new StringBuffer();for(var i=0;i<tags.length;i++){htmlText.append("<li onmouseover=\"this.className='hover'\" onmouseout=\"this.className=''\" onmousedown=\"this.parentNode.instance.suggestionMouseClick(this)\" style=\"background-color: #ccb\"><strong>");htmlText.append(tags[i].substring(0,input.value.length).htmlspecialchars().replaceAll("&amp;","&"));htmlText.append("</strong>");htmlText.append(tags[i].substring(input.value.length).htmlspecialchars().replaceAll("&amp;","&"));htmlText.append("</li>")}if(instance.allowEolinSuggestion)htmlText.append(instance.suggestion.innerHTML);instance.suggestion.innerHTML=htmlText.toString();if(!instance.allowEolinSuggestion||instance.getInput().value.trim()==""){instance.suggestion.style.left=getOffsetLeft(input)+"px";instance.suggestion.style.top=getOffsetTop(input)+input.offsetHeight+"px";instance.suggestion.style.display="block";instance.isSuggestionShown=true;try{document.body.removeChild(instance.suggestion)}catch(e){};document.body.appendChild(instance.suggestion)}while(instance.suggestion.childNodes.length>10)instance.suggestion.removeChild(instance.suggestion.childNodes[instance.suggestion.childNodes.length-1])}}catch(e){}}};xmlhttp.send(null);delete xmlhttp}}function tcTagFunction_showLocalSuggestionWithoutQuery(id,cursor,filter){return tcTagFunction_showLocalSuggestion(id,cursor,'name like "'+filter.replace('"','\\"')+'%"')}function tcTagFunction_showSuggestion(){try{var instance=document.getElementById(arguments[0]).instance}catch(e){return}if(instance.cursor!=arguments[1]||!instance.isTyping)return;var input=instance.getInput();if(input.value.trim()==""){instance.hideSuggestion();return}instance.suggestion.style.left=getOffsetLeft(input)+"px";instance.suggestion.style.top=getOffsetTop(input)+input.offsetHeight+"px";var htmlText=new StringBuffer();if(arguments[2]==0){for(var i=3;i<arguments.length;i++){arguments[i]=arguments[i].replaceAll("&quot;",'"');if(STD.isSafari)arguments[i]=decodeURIComponent(arguments[i]);htmlText.append("<li onmouseover=\"this.className='hover'\" onmouseout=\"this.className=''\" onmousedown=\"this.parentNode.instance.suggestionMouseClick(this)\"><strong>");htmlText.append(arguments[i].substring(0,input.value.length).htmlspecialchars().replace("&amp;","&"));htmlText.append("</strong>");htmlText.append(arguments[i].substring(input.value.length).htmlspecialchars().replace("&amp;","&"));htmlText.append("</li>")}}else{if(STD.isSafari)arguments[3]=decodeURIComponent(arguments[3]);htmlText.append("<li class=\"disabled\">");htmlText.append("<strong>");htmlText.append(input.value.htmlspecialchars());htmlText.append("</strong> - "+arguments[3]+"</li>")}instance.suggestion.innerHTML=htmlText.toString();instance.suggestion.style.display="block";instance.isSuggestionShown=true;try{document.body.removeChild(instance.suggestion)}catch(e){};document.body.appendChild(instance.suggestion)}function Tag(container,language,disable){this.name="Eolin Tag Object";this.copyright="Tatter & Company";this.allowEolinSuggestion=(typeof(disable)=="undefined")?false:!disable;this.isSettingValue=false;this.instance=this;this.cursor=0;this.isTyping=false;this.isSuggestionShown=false;this.typingText="";this.inputClassName="";this.language="ko";if(typeof language!="undefined")this.language=language;this.container=container;this.container.instance=this;this.suggestion=document.createElement("ul");this.suggestion.instance=this;this.suggestion.selectedIndex=0;this.suggestion.className="tcSuggest";this.suggestion.style.margin="0px";this.suggestion.style.padding="0px";this.suggestion.style.listStyleType="none";this.suggestion.style.position="absolute";this.suggestion.style.display="none";this.suggestion.style.zIndex="999";setInterval("tcTagFunction_WatchInputBox('"+this.container.id+"')",10);this.inputOnLast=this.createSuggestInput();this.inputTemporary=null;this.tagList=document.createElement("ul");this.tagList.instance=this;var listItem=document.createElement("li");listItem.className="lastChild";listItem.appendChild(this.inputOnLast);this.tagList.appendChild(listItem);this.container.appendChild(this.tagList)}Tag.prototype.isTemporaryEditing=function(){return(this.inputTemporary!=null)};Tag.prototype.setInputClassName=function(str){this.inputClassName=str;this.inputOnLast.className=str;if(this.inputTemporary)this.inputTemporary.className=str};Tag.prototype.getInput=function(){return(this.inputTemporary==null)?this.inputOnLast:this.inputTemporary};Tag.prototype.adjustEventCompatibility=function(event){if(navigator.appName=="Microsoft Internet Explorer"){event=window.event;event.target=event.srcElement}return event};Tag.prototype.createSuggestInput=function(){var input=document.createElement("input");input.instance=this;input.className=this.inputClassName;input.setAttribute("autocomplete","off");input.onblur=function(){var instance=this.instance;instance.isTyping=false;instance.hideSuggestion();instance.setValue(this.value)};input.onclick=this.requestSuggestion;input.onkeydown=function(event){var instance=this.instance;instance.isTyping=true;event=instance.adjustEventCompatibility(event);switch(event.keyCode){case 8:if(this.value=="")instance.moveBack();else return event.keyCode;break;case 13:instance.setValue(this.value);break;case 188:if(!event.shiftKey)instance.setValue(this.value);else return event.keyCode;break;case 9:if(this.value.trim()=="")return event.keyCode;instance.setValue(this.value);break;case 27:instance.hideSuggestion();break;case 38:instance.moveUp();break;case 40:instance.moveDown();break;default:return event.keyCode}event.returnValue=false;event.cancelBubble=true;try{event.preventDefault()}catch(e){}return false};input.onkeypress=function(event){return preventEnter(event)};return input};Tag.prototype.suggestionMouseClick=function(obj){var input=this.getInput();this.hideSuggestion();this.setValue(obj.innerHTML.replace(new RegExp("<\/?strong>","gi"),"").replaceAll("&amp;","&"))};Tag.prototype.requestSuggestion=function(){var instance=this.instance;instance.isTyping=true;instance.cursor++;if(!instance.allowEolinSuggestion||(instance.getInput().value.trim()=="")){tcTagFunction_showLocalSuggestionWithoutQuery(instance.container.getAttribute("id"),instance.cursor,instance.getInput().value);return}var script=document.createElement("script");script.setAttribute("src","http://suggest.tc.com/tag/tatter/?id="+instance.container.getAttribute("id")+"&cursor="+instance.cursor+"&language="+instance.language+"&word="+encodeURIComponent(instance.getInput().value)+(STD.isSafari?"&encode=1":""));document.body.appendChild(script)};Tag.prototype.moveBack=function(){var prevNode=this.getInput().parentNode.previousSibling;if(this.tagList.childNodes.length>1&&prevNode){this.hideSuggestion();var text=prevNode.innerHTML.unhtmlspecialchars();prevNode.parentNode.removeChild(prevNode);this.tagList.lastChild.className="lastChild";this.getInput().value=text}};Tag.prototype.moveUp=function(){if(this.isSuggestionShown){this.cursor++;this.suggestion.selectedIndex--;if(this.suggestion.selectedIndex<1)this.suggestion.selectedIndex=this.suggestion.childNodes.length;this.highlightRow()}};Tag.prototype.moveDown=function(){if(this.isSuggestionShown){this.cursor++;this.suggestion.selectedIndex++;if(this.suggestion.selectedIndex>this.suggestion.childNodes.length)this.suggestion.selectedIndex=1;this.highlightRow()}};Tag.prototype.highlightRow=function(){if(this.isSuggestionShown&&this.suggestion.childNodes[0].className!="disabled"){for(var i=0;i<this.suggestion.childNodes.length;i++)this.suggestion.childNodes[i].className=(i==this.suggestion.selectedIndex-1)?"hover":"";this.getInput().value=this.typingText=this.suggestion.childNodes[this.suggestion.selectedIndex-1].innerHTML.replace(new RegExp("<\/?strong>","gi"),"").unhtmlspecialchars()}};Tag.prototype.getValues=function(){var values=new Array();for(var i=0;i<this.tagList.childNodes.length-1;i++)values[i]=this.tagList.childNodes[i].innerHTML.trim().unhtmlspecialchars();return values};Tag.prototype.setValue=function(str){if(this.isSettingValue)return;else this.isSettingValue=true;this.hideSuggestion();if(this.isTemporaryEditing()){this.inputTemporary.parentNode.onclick=this.tagListMouseClick;if(str.trim()=="")this.inputTemporary.parentNode.parentNode.removeChild(this.inputTemporary.parentNode);else this.inputTemporary.parentNode.innerHTML=str;this.typingText="";this.inputTemporary=null}else if(str.trim()!=""){var inputContainer=this.tagList.lastChild;inputContainer.className="";var listItem=document.createElement("li");listItem.onclick=this.tagListMouseClick;listItem.appendChild(document.createTextNode(str));this.tagList.removeChild(inputContainer);this.tagList.appendChild(listItem);this.tagList.appendChild(inputContainer);this.typingText="";this.inputOnLast.value="";this.focusOnInput()}this.tagList.lastChild.className="lastChild";this.isSettingValue=false};Tag.prototype.tagListMouseClick=function(){var instance=this.parentNode.instance;instance.inputTemporary=instance.createSuggestInput();instance.inputTemporary.value=this.innerHTML.unhtmlspecialchars();instance.typingText=this.innerHTML;this.innerHTML="";this.onclick=null;this.appendChild(instance.inputTemporary);instance.focusOnInput();instance.requestSuggestion()};Tag.prototype.hideSuggestion=function(){this.isSuggestionShown=false;this.suggestion.style.display="none";this.suggestion.selectedIndex=0};Tag.prototype.focusOnInput=function(){this.getInput().focus();this.getInput().select()};function getOffsetTop(obj){return obj?obj.offsetTop+getOffsetTop(obj.offsetParent):0}function getOffsetLeft(obj){return obj?obj.offsetLeft+getOffsetLeft(obj.offsetParent):0}var StringBuffer=function(){this.buffer=new Array()};StringBuffer.prototype.append=function(str){this.buffer[this.buffer.length]=str};StringBuffer.prototype.toString=function(){return this.buffer.join("")};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(new RegExp("(^\\s*)|(\\s*$)","g"),"")}}if(!String.prototype.htmlspecialchars){String.prototype.htmlspecialchars=function(){return this.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll("<","&gt;")}}if(!String.prototype.unhtmlspecialchars){String.prototype.unhtmlspecialchars=function(){return this.replaceAll("&amp;","&").replaceAll("&lt;","<").replaceAll("&gt;",">")}}var x=0;function debug(s){try{document.getElementById("debug").innerHTML=++x+")"+s+"<br />"+document.getElementById("debug").innerHTML}catch(e){}}