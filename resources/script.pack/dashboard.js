// requires jQuery's UI plugin 1.6
(function(a){function b(b){var c=a("#widget-container-0").sortable("toArray");c.push("TextcubeSeparator"),a.merge(c,a("#widget-container-1").sortable("toArray")),c.push("TextcubeSeparator"),a.merge(c,a("#widget-container-2").sortable("toArray"));var d=0,e=0;for(e=0;e<c.length;e++)if(c[e].trim()!=""){if(c[e]==b)return d;d++}return-1}editMode&&a(function(){a(".widget-container").sortable({connectWith:[".widget-container"],start:function(c,d){var e=b(d.item.attr("id"));a.data(d.item[0],"prev_pos",e),a.data(d.item[0],"sent",!1)},update:function(c,d){if(!a.data(d.item[0],"sent")){var e=b(d.item.attr("id")),f=a.data(d.item[0],"prev_pos"),g=0;f!=undefined&&(g=e-f),a.removeData(d.item,"prev_pos");var h="dashboard?ajaxcall=true&edit=true&pos="+f+"&rel="+g;a.post(h),a.data(d.item[0],"sent",!0)}},placeholder:"widget-state-highlight",opacity:.65}),a(".widget-container .section").css("cursor","pointer")})})(jQuery)