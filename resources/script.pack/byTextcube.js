/// Copyright (c) 2004-2011, Needlworks  / Tatter Network Foundation
/// All rights reserved. Licensed under the GPL.
/// See the GNU General Public License for more details. (/documents/LICENSE, /documents/COPYRIGHT)
//<![CDATA[
function close_mark_set(a,b,c){layer_toggle(document.getElementById("mark_set")),set_tag_support(a,'<span style="color: '+b+"; background-color: "+c+'; padding: 3px 1px 0px">',"</span>")}function close_color_set(a,b){layer_toggle(document.getElementById("color_set")),set_tag_support(a,'<span style="color: '+b+'">',"</span>")}function open_set(a){a=="mark_set"?document.getElementById("color_set").style.display="none":document.getElementById("mark_set").style.display="none",layer_toggle(document.getElementById(a))}function set_tag_support(a,b,c){if(document.selection)a.createTextRange&&a.currentPos?(a.currentPos.text=b+a.currentPos.text+c,a.focus(),save_pos(a)):a.value=a.value+b+c;else if(a.selectionStart&&a.selectionEnd){var d=a.value.substring(0,a.selectionStart),e=a.value.substring(a.selectionStart,a.selectionEnd),f=a.value.substring(a.selectionEnd);a.value=d+b+e+c+f}else a.value+=b+c;return!0}function save_pos(a){a.createTextRange&&(a.currentPos=document.selection.createRange().duplicate());return!0}function count_days(a,b){var c;b==1||b==3||b==5||b==7||b==8||b==10||b==12?c=31:b==4||b==6||b==9||b==11?c=30:b==2&&(a%4==0&&a%100!=0||a%400==0?c=29:c=28);return c}function check_date(a,b,c,d,e,f){if(a<1900||a=="")return!1;if(b>12||b=="")return!1;if(c>count_days(a,b)||c=="")return!1;if(d>23||d=="")return!1;if(e>60||e=="")return!1;if(f>60||f=="")return!1;return!0}function set_preview_no_image(a){a.src=servicePath+adminSkin+"/image/spacer.gif"}function set_preview_image(a,b,c,d){temp=a.options[a.selectedIndex].value.split("|");var e=temp[2].substring(temp[2].length-3).toLowerCase();e!="jpg"&&e!="gif"&&e!="bmp"&&e!="png"?set_preview_no_image(b):b.src=servicePath+"/attach/"+c+d+temp[2];return!0}function check_cb_set(a){var b=form.elements,c="";a.checked?c=!0:c=!1;for(i=0;i<b.length;i++)b[i].type=="Checkbox"&&b[i].name.substring(0,4)=="cb_r"&&(b[i].checked=c)}function is_valid_time(a){var b=a.substring(0,4).replace(/\D/g,""),c=a.substring(5,7).replace(/\D/g,""),d=a.substring(8,10).replace(/\D/g,""),e=a.substring(11,13).replace(/\D/g,""),f=a.substring(14,16).replace(/\D/g,""),g=a.substring(17,19).replace(/\D/g,"");if(check_date(b,c,d,e,f,g))return!0;alert("시각을 바르게 입력해 주십시오");return!1}function image_view(a,b,c){window.open(b+"image_pop.php?p_title="+c+"&imagefile="+a.src+"&width="+a.style.width+"&height="+a.style.height,"_blank","width="+a.style.width+",height="+a.style.height+",location=0,menubar=0,resizable=0,scrollbars=0,status=0,toolbar=0")}function onclick_to_article_free(a,b,c,d){var e="";for(var f=0;f<a.options.length;f++)a.options[f].selected==!0&&(temp=a.options[f].value.split("|"),e=e+'<img src="'+c+d+temp[2]+'" '+temp[1]+">");set_tag_support(b,e,"");return!0}function onclick_to_article_slide(a,b,c){var d="";for(var e=0;e<a.options.length;e++)a.options[e].selected==!0&&(temp=a.options[e].value.split("|"),d=d+"^"+temp[2]+"|"+temp[1]+"|");var f;trim(d)!=""&&(d=d.substr(1)),f=d.split("^"),d="[##_S";for(e=0;e<f.length;e++)d=d+"|"+f[e];d=d+"_##]",form.buffer.value=d,window.open("post_pop.php?view=1&mode=s","post_pop","width=400, height=300, scrollbars=1, status=1");return!0}function onclick_to_article_3c(a,b,c){var d=0,e="";for(var f=0;f<a.options.length;f++)a.options[f].selected==!0&&(temp=a.options[f].value.split("|"),e=e+"^"+temp[2]+"|"+temp[1]+"|",d++);if(d!=3){alert(c);return!1}var g;trim(e)!=""&&(e=e.substr(1)),g=e.split("^"),e="[##_3C|"+g[0]+"|"+g[1]+"|"+g[2]+"_##]",form.buffer.value=e,window.open("post_pop.php?view=1&mode=3C","post_pop","width=400, height=300, scrollbars=1, status=1");return!0}function onclick_to_article_2c(a,b,c){var d=0,e="";for(var f=0;f<a.options.length;f++)a.options[f].selected==!0&&(temp=a.options[f].value.split("|"),e=e+"^"+temp[2]+"|"+temp[1]+"|",d++);if(d!=2){alert(c);return!1}var g;trim(e)!=""&&(e=e.substr(1)),g=e.split("^"),e="[##_2C|"+g[0]+" |"+g[1]+" _##]",form.buffer.value=e,window.open("post_pop.php?view=1&mode=2C","post_pop","width=400, height=300, scrollbars=1, status=1");return!0}function onclick_to_article_1r(a,b,c){if(a.selectedIndex==-1){alert(c);return!1}var d="";temp=a.options[a.selectedIndex].value.split("|"),d="[##_1R|"+temp[2]+"|"+temp[1]+"|_##]",form.buffer.value=d,window.open("post_pop.php?view=1&mode=1R","post_pop","width=400, height=300, scrollbars=1, status=1");return!0}function onclick_to_article_1c(a,b,c){if(a.selectedIndex==-1){alert(c);return!1}var d="";temp=a.options[a.selectedIndex].value.split("|"),d="[##_1C|"+temp[2]+"|"+temp[1]+"|_##]",form.buffer.value=d,window.open("post_pop.php?view=1&mode=1C","post_pop","width=400, height=300, scrollbars=1, status=1");return!0}function onclick_to_article_1l(a,b,c){if(a.selectedIndex==-1){alert(c);return!1}var d="";temp=a.options[a.selectedIndex].value.split("|"),d="[##_1L|"+temp[2]+"|"+temp[1]+"|_##]",form.buffer.value=d,window.open("post_pop.php?view=1&mode=1L","post_pop","width=400, height=300, scrollbars=1, status=1");return!0}function onclick_delete(a,b,c){window.open("del_exe.php?mode="+a+"&pnum="+b+"&num="+c,"del","width=350,height=200,location=0,menubar=0,resizable=0,scrollbars=0,status=0,toolbar=0")}function onclick_addexe(num,d_target,obj1,obj2,mode){if(obj1.value==0)obj1.value="1",obj2.value="0",exe_frame.location.href="add_exe.php?md="+mode+"&num="+num+"&d_target="+d_target;else{obj1.value="0";var ele=eval(document.getElementById(d_target));ele.style.display="none",ele.innerHTML=""}return!0}function onclick_insert_comment(form,num){trim_all(form);if(isNull(eval("form.c_name_"+num),"이름을 입력해 주십시오."))return!1;if(isNull(eval("form.c_body_"+num),"답글을 입력해 주십시오"))return!1;if(!confirm("답글을 올리시겠습니까?\t"))return!1;form.target="exe_frame",form.action="add_exe.php",form.md.value="insert",form.num.value=num,form.c_name.value=eval("form.c_name_"+num).value,form.c_homepage.value=eval("form.c_homepage_"+num).value,form.c_password.value=eval("form.c_password_"+num).value,form.c_body.value=eval("form.c_body_"+num).value,form.d_target.value="post_"+num,form.submit(),form.target="_self",form.action="index.php",form.md.value="",form.num.value=""}function onclick_edit_guest(a,b,c,d,e){trim_all(a);if(isNull(a.guest_input_name,"이름을 입력해 주십시오."))return!1;if(isNull(a.guest_textarea_body,"본문을 입력해 주십시오"))return!1;a.md.value="guest_db",a.act.value="edit",a.pnum.value=b,a.num.value=c,a.page.value=d,a.sort.value=e,a.submit()}function onclick_insert_guest(a,b,c,d,e){trim_all(a);if(isNull(a.guest_input_name,"이름을 입력해 주십시오."))return!1;if(isNull(a.guest_textarea_body,"본문을 입력해 주십시오"))return!1;if(a.guest_input_password.value==""&&!confirm("비밀번호를 입력하지 않으면 나중에 수정하실 수 없습니다.\t\n\n계속 진행하시겠습니까?"))return!1;a.md.value="guest_db",a.act.value=b,a.num.value=c,a.page.value=d,a.sort.value=e,a.submit()}function del_list(a){var b="";for(var c=0;c<a.options.length;c++)a.options[c].selected==!0&&(b=b+"^"+c+"|"+a.options[c].value);return b}function add_list(a,b,c){loc=a.length,a.options[loc]=new Option(b,c),a.selectedIndex=loc}function set_tree_status(){var a,b="";for(i=0;i<d_ary.length;i++)a=document.getElementById("h_ct"+d_ary[i]),a&&a.style.display=="block"&&(b+=","+d_ary[i]);return b}function onclick_folder(a,b,c,d){b=document.getElementById(b),c=document.getElementById(c);if(b==null)return!1;sn_set=f_ary[a].toString(),sn_set=sn_set.split(",");var e=sn_set[0],f=sn_set[1],g=sn_set[2];b.style.display=="none"?f=="0"?g=="1"?c.src=d+"tab"+e+"_opened6.gif":c.src=d+"tab"+e+"_opened5.gif":g=="1"?c.src=d+"tab"+e+"_opened2.gif":c.src=d+"tab"+e+"_opened1.gif":g=="1"?f=="0"?c.src=d+"tab"+e+"_opened6.gif":c.src=d+"tab"+e+"_closed2.gif":f=="0"?c.src=d+"tab"+e+"_opened5.gif":c.src=d+"tab"+e+"_closed1.gif",layer_toggle(b);return!1}function onclick_setimp(a,b){a.style.color=c2,a.style.backgroundColor=bc2;for(i=0;i<b.length;i++){var c=document.getElementById("imp"+b[i]);c.style.color=c1,c.style.backgroundColor=bc1}a.style.color=c2,a.style.backgroundColor=bc2}function has_leaves(a,b){for(i=0;i<a.length;i++)if(b==a[i][0]&&a[i][1]=="0")return!1;return!0}function layer_toggle2(a,b){a.style.display="block",b.style.display="none"}function layer_toggle(a){a.style.display=="none"?a.style.display="block":a.style.display=="block"&&(a.style.display="none")}function isNull(a,b){if(a.value.length==0){alert(b+"\t"),a.type!="hidden"&&a.focus();return!0}return!1}function str_innerHTML(a){a=a.replace(/-\_t-t\_-/g,"\n");return a}function submit_type3(a){form.method="get",form.action=a,form.target="_self",form.submit()}function submit_type2(a){form.method="post",form.action=a,form.target="exe_frame",form.submit()}function submit_type1(a){form.method="post",form.action=a,form.target="_self",form.submit()}function trim_all(a){var b=0;while(b<a.length)a.elements[b].type!="file"&&(a.elements[b].value=trim(a.elements[b].value)),b++;return!0}function trim(a){while(a)if(a.indexOf(" ")==0)a=a.substring(1);else break;while(a)if(a.lastIndexOf(" ")==a.length-1)a=a.substring(0,a.length-1);else break;return a}var IE=document.all?!0:!1