/*
   Copyright (c) 2007-9, iUI Project Members
   See LICENSE.txt for licensing terms
 */function closeKeypad(){var a=document.getElementById("searchButton");a!=null&&a.focus()}function searchKeywordCheck(a){var b=document.getElementById("clearButton");a.value.length>0?b.style.display="block":b.style.display="none"}function cancelAction(a){var b=document.getElementById("qString");b.value.length>0&&(b.value="",a.style.display="none")}function searchAction(a){var b=document.getElementById("qString"),c=document.getElementById("clearButton");b.value.length>0&&a==!1&&(b.value="",c.style.display="none",window.scroll(0,0))}function emailSaveToggleCheck(a){var b=document.getElementById("save");a.getAttribute("toggled")=="true"?b.value=1:b.value=0}function secretToggleCheck(a,b){var c=document.getElementById("secret_"+b);a.getAttribute("toggled")=="true"?c.value=1:c.value=0}function looseURIEncode(a){a=a.replace(new RegExp("%","g"),"%25"),a=a.replace(new RegExp("\\?","g"),"%3F"),a=a.replace(new RegExp("#","g"),"%23");return a}(function(){function G(){console.log.apply(console,arguments)}function F(a){return document.getElementById(a)}function E(a,b){var c=a.parentNode,d=a;while(c.parentNode!=document.body)c=c.parentNode,d=d.parentNode;var e=document.createElement(d.localName);e.innerHTML=b,c.removeChild(d);while(e.firstChild)c.appendChild(e.firstChild)}function D(a,b){var c=new RegExp("(^|\\s)"+b+"($|\\s)");return c.exec(a.getAttribute("class"))!=null}function C(a,b){while(a&&(a.nodeType!=1||a.localName.toLowerCase()!=b))a=a.parentNode;return a}function B(a){function b(a){for(var b=0;b<a.length;++b)a[b].name&&c.push(a[b].name+"="+looseURIEncode(a[b].value))}var c=[];b(a.getElementsByTagName("input")),b(a.getElementsByTagName("textarea")),b(a.getElementsByTagName("select"));return c}function A(a){iui.showPageByHref(a.action||"POST",B(a),a.method),closeKeypad()}function z(){var a=document.createElement("div");a.id="preloader",document.body.appendChild(a)}function y(a,b,c,d){function g(){a.style.webkitTransform=f,b.style.webkitTransform="translateX(0%)"}b.style.webkitTransitionDuration="0ms";var e="translateX("+(c?"-":"")+window.innerWidth+"px)",f="translateX("+(c?"100%":"-100%")+")";b.style.webkitTransform=e,b.setAttribute("selected","true"),b.style.webkitTransitionDuration="",a.addEventListener("webkitTransitionEnd",d,!1),setTimeout(g,0)}function x(c,d,e,f,g){function j(){h-=a,h<=0&&(h=0,clearInterval(i),g()),f=="y"?e?c.style.top=100-h+"%":d.style.top=h+"%":(c.style.left=(e?100-h:h-100)+"%",d.style.left=(e?-h:h)+"%")}f=="y"?(e?c:d).style.top="100%":d.style.left="100%",scrollTo(0,1),d.setAttribute("selected","true");var h=100;j();var i=setInterval(j,b)}function w(){return iui.animOn&&typeof WebKitCSSMatrix=="object"}function v(a,b,c){function e(){D(b,"dialog")||a.removeAttribute("selected"),j=setInterval(p,300),setTimeout(u,0,b,a),a.removeEventListener("webkitTransitionEnd",e,!1)}var d=(c?a:b).getAttribute("axis");clearInterval(j),w()&&d!="y"?y(a,b,c,e):x(a,b,c,d,e),window.scroll(0,0)}function u(a,b){a.id||(a.id="__"+ ++i+"__"),location.hash=f=g+a.id,h.push(a.id);var c=F("pageTitle");a.title&&(c.innerHTML=a.title),a.localName.toLowerCase()=="form"&&!a.target&&s(a);var d=F("backButton");if(d){var e=F(h[h.length-2]);e&&!a.getAttribute("hideBackButton")?(d.style.display="inline",d.innerHTML=e.title?e.title:"Back"):d.style.display="none"}}function t(a){a.removeAttribute("selected")}function s(a){a.onsubmit=function(b){b.preventDefault(),A(a)},a.onclick=function(b){b.target==a&&D(a,"dialog")&&t(a)}}function r(a){d=a,a.setAttribute("selected","true"),D(a,"dialog")&&!a.target&&s(a)}function q(a){document.body.setAttribute("orient",a),setTimeout(scrollTo,100,0,1)}function p(){if(!k&&window.innerWidth!=e){e=window.innerWidth;var a=e==320?l:m;q(a)}if(location.hash!=f){var b=location.hash.substr(g.length);iui.showPageById(b)}}function o(){var a=window.orientation;switch(a){case 0:q(l);break;case 90:case-90:q(m)}}function n(){var a,b=location.hash.match(/#_([^\?_]+)/);b&&(a=b[1]),a&&(a=F(a));return a}var a=30,b=0,c=null,d=null,e=0,f=location.hash,g="#_",h=[],i=0,j,k=!1,l="portrait",m="landscape";window.iui={animOn:!0,showPage:function(a,b){if(a){d&&(d.removeAttribute("selected"),d=null);if(D(a,"dialog"))r(a);else{var e=c;c=a,e?setTimeout(v,0,e,a,b):u(a,e)}}},showPageById:function(a){var b=F(a);if(b){var c=h.indexOf(a),d=c!=-1;d&&h.splice(c,h.length),iui.showPage(b,d)}},showPageByHref:function(a,b,c,d,e){var f=new XMLHttpRequest;f.onerror=function(){e&&e(!1)},f.onreadystatechange=function(){if(f.readyState==4){if(d)E(d,f.responseText);else{var a=document.createElement("div");a.innerHTML=f.responseText,iui.insertPages(a.childNodes)}e&&setTimeout(e,1e3,!0)}},b?(a=a+"?"+b.join("&"),f.open(c||"GET",a,!0),f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.setRequestHeader("Content-Length",b.length),f.send(null)):(f.open(c||"GET",a,!0),f.send(null))},insertPages:function(a){var b;for(var c=0;c<a.length;++c){var d=a[c];if(d.nodeType==1){d.id||(d.id="__"+ ++i+"__");var e=F(d.id);e?e.parentNode.replaceChild(d,e):document.body.appendChild(d);if(d.getAttribute("selected")=="true"||!b)b=d;--c}}b&&iui.showPage(b)},getSelectedPage:function(){for(var a=document.body.firstChild;a;a=a.nextSibling)if(a.nodeType==1&&a.getAttribute("selected")=="true")return a},isNativeUrl:function(a){for(var b=0;b<iui.nativeUrlPatterns.length;b++)if(a.match(iui.nativeUrlPatterns[b]))return!0;return!1},nativeUrlPatterns:[new RegExp("^http://maps.google.com/maps?"),new RegExp("^mailto:"),new RegExp("^tel:"),new RegExp("^http://www.youtube.com/watch\\?v="),new RegExp("^http://www.youtube.com/v/"),new RegExp("^javascript:")]},addEventListener("load",function(a){var b=iui.getSelectedPage(),c=n();b&&iui.showPage(b),c&&c!=b&&iui.showPage(c),setTimeout(z,0),typeof window.onorientationchange=="object"&&(window.onorientationchange=o,k=!0,setTimeout(o,0)),setTimeout(p,0),j=setInterval(p,300)},!1),addEventListener("unload",function(a){return},!1),addEventListener("click",function(a){var b=C(a.target,"a");if(b){function c(){b.removeAttribute("selected")}if(b.href&&b.hash&&b.hash!="#"&&!b.target)b.setAttribute("selected","true"),iui.showPage(F(b.hash.substr(1))),setTimeout(c,500);else if(b==F("backButton"))history.back();else if(b.getAttribute("type")=="submit"){var d=C(b,"form");if(d.target=="_self"){d.submit();return}A(d)}else if(b.getAttribute("type")=="cancel")t(C(b,"form"));else if(b.target=="_replace")b.setAttribute("selected","progress"),iui.showPageByHref(b.href,null,null,b,c);else{if(iui.isNativeUrl(b.href))return;if(b.target=="_webapp")location.href=b.href;else if(!b.target)b.setAttribute("selected","progress"),iui.showPageByHref(b.href,null,null,null,c);else return}a.preventDefault()}},!0),addEventListener("click",function(a){var b=C(a.target,"div");b&&D(b,"toggle")&&(b.setAttribute("toggled",b.getAttribute("toggled")!="true"),a.preventDefault())},!0)})()