/// Copyright (c) 2004-2010, Needlworks  / Tatter Network Foundation
/// All rights reserved. Licensed under the GPL.
/// See the GNU General Public License for more details. (/documents/LICENSE, /documents/COPYRIGHT)
function editorAddObject(a,b){var c=document.forms[0].TCfilelist,d=[],e={mode:b};switch(b){case"Image1L":case"Image1C":case"Image1R":case"Image2C":case"Image3C":var f=parseInt(b.substr(5));for(var g=0;g<c.options.length;g++)if(c.options[g].selected==!0){var h=c.options[g].value.split("|"),i=(new RegExp("width=['\"]?(\\d+)")).exec(h[1]),j=(new RegExp("height=['\"]?(\\d+)")).exec(h[1]);i&&j&&(orgWidth=i[1],orgHeight=j[1],orgWidth>skinContentWidth/f&&(width=parseInt(skinContentWidth/f),height=parseInt(orgHeight*(skinContentWidth/f/orgWidth)),h[1]=h[1].replace(new RegExp("width=['\"]?\\d+['\"]?","gi"),'width="'+width+'"'),h[1]=h[1].replace(new RegExp("height=['\"]?\\d+['\"]?","gi"),'height="'+height+'"'))),h.length<3&&h.push(""),d.push(h)}if(d.length!=f){switch(f){case 1:alert(_t("파일을 선택하십시오."));break;case 2:alert(_t("파일 리스트에서 이미지를 2개 선택해 주십시오. (ctrl + 마우스 왼쪽 클릭)"));break;case 3:alert(_t("파일 리스트에서 이미지를 3개 선택해 주십시오. (ctrl + 마우스 왼쪽 클릭)"))}return!1}break;case"ImageFree":for(var g=0;g<c.options.length;g++)if(c.options[g].selected){var h=c.options[g].value.split("|");(new RegExp("\\.(gif|jpe?g|png|bmp)$","i")).test(h[0])&&d.push(h)}break;case"Imazing":case"Gallery":try{if(c.selectedIndex<0){alert(_t("파일을 선택하십시오."));return!1}var h=c.options[c.selectedIndex].value.split("|"),k=!1;for(var g=0;g<c.length;g++){if(!c.options[g].selected)continue;file=c[g].value.substr(c[g].value,c[g].value.indexOf("|")),(new RegExp("\\.(jpe?g|gif|png)$","gi")).exec(file)?d.push([file,""]):k=!0}if(d.length==0){alert(_t("이미지 파일만 삽입 가능합니다."));return!1}if(b=="Imazing"){k&&alert(_t("iMazing 갤러리는 JPG,PNG,GIF 파일만 지원됩니다\n그 외의 형식은 목록에서 제외했습니다"));var l="";for(var m in iMazingProperties)l+=m+"="+iMazingProperties[m]+" ";e.properties=l}}catch(n){return!1}break;case"Jukebox":try{if(c.selectedIndex<0){alert(_t("파일을 선택하십시오."));return!1}var h=c.options[c.selectedIndex].value.split("|");for(var g=0;g<c.length;g++){if(!c.options[g].selected)continue;file=c[g].value.substr(c[g].value,c[g].value.indexOf("|"));if((new RegExp("\\.mp3$","gi")).exec(file)){var o="",p;if(p=(new RegExp("(.*)\\.mp3","gi")).exec(c.options[g].text))o=p[1].replaceAll("|","");d.push([file,o])}}if(d.length==0){alert(_t("MP3 파일만 삽입 가능합니다."));return!1}}catch(n){return!1}break;default:return!1}e.objects=d;return a.addObject(e)}var TTEditorResizer=function(a,b,c){this.target=a,this.documents=c||[document],this.resizer=b,this.rowResize=this.rowResizeDown=!1,this.onResizeBegin=function(){},this.onResizeEnd=function(){}};TTEditorResizer.prototype.initialize=function(){var a=jQuery.proxy(this.docEventHandler,this);for(var b=0,c;c=this.documents[b];++b)STD.addEventListener(c),jQuery(c).bind({"mousemove.doc":a,"mousedown.doc":a,"mouseup.doc":a,"selectstart.doc":a})},TTEditorResizer.prototype.finalize=function(){for(var a=0,b;b=this.documents[a];++a)jQuery(b).unbind(".doc")},TTEditorResizer.prototype.docEventHandler=function(a){switch(a.type){case"mousemove":if(this.rowResizeDown){var b=parseInt(a.clientY);a.target.tagName!="BODY"&&a.target.tagName!="HTML"&&(b+=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,b-=getOffsetTop(this.target));try{this.target.style.height=Math.min(2600,Math.max(300,b))+"px"}catch(c){}}else a.target==this.resizer?this.rowResize=!0:this.rowResize=!1;break;case"mousedown":this.rowResizeDown=!1,this.rowResize&&(this.onResizeBegin.apply(this),this.rowResizeDown=!0);break;case"mouseup":this.rowResizeDown=!1,this.onResizeEnd.apply(this);break;case"selectstart":return this.rowResizeDown?!1:!0}};var TTDefaultEditor=function(){};TTDefaultEditor.prototype.initialize=function(a){this.textarea=a;var b=this;STD.addEventListener(a);var c=function(){editorChanged(),savePosition(b.textarea);return!0};this.textareaEventHandler_bounded=c,a.addEventListener("select",c,!1),a.addEventListener("click",c,!1),a.addEventListener("keyup",c,!1),this.resizer=new TTEditorResizer(a,getObject("status-container")),this.resizer.onResizeBegin=function(){getObject("attachManagerSelectNest").style.visibility="hidden"},this.resizer.onResizeEnd=function(){getObject("attachManagerSelectNest").style.visibility="visible"},this.resizer.initialize()},TTDefaultEditor.prototype.finalize=function(){this.resizer.finalize();var a=this.textarea;a.removeEventListener("select",this.textareaEventHandler_bounded,!1),a.removeEventListener("click",this.textareaEventHandler_bounded,!1),a.removeEventListener("keyup",this.textareaEventHandler_bounded,!1)},TTDefaultEditor.prototype.syncTextarea=function(){},TTDefaultEditor.prototype.addObject=function(a){switch(a.mode){case"Image1L":case"Image1C":case"Image1R":case"ImageFree":var b=a.objects[0][2].replace(new RegExp('"',"g"),"&quot;").replace(new RegExp("'","g"),"&#39;");a.mode=="Image1L"&&(a.objects[0][1]+=' style="float: left;"'),a.mode=="Image1R"&&(a.objects[0][1]+=' style="float: right;"');var c='<img src="[##_ATTACH_PATH_##]/'+a.objects[0][0]+'" '+a.objects[0][1]+' title="'+b+'" />';a.mode=="Image1C"&&(c='<p style="text-align: center;">'+c+"</p>\n"),insertTag(this.textarea,c,"");return!0;case"Image2C":case"Image3C":case"Gallery":for(var d=0;a.objects[d];++d){a.mode=="Gallery"&&a.objects[d].push("");if(!this.addObject({mode:"Image1C",objects:[a.objects[d]]}))return!1}return!0;case"Imazing":alert(_t("이 편집기에서는 iMazing 갤러리를 지원하지 않습니다."));return!1;case"Jukebox":alert(_t("이 편집기에서는 주크박스를 지원하지 않습니다."));return!1}return!1};var iMazingProperties=[];iMazingProperties.width=450,iMazingProperties.height=350,iMazingProperties.frame="net_imazing_frame_none",iMazingProperties.transition="net_imazing_show_window_transition_alpha",iMazingProperties.navigation="net_imazing_show_window_navigation_simple",iMazingProperties.slideshowInterval=10,iMazingProperties.page=1,iMazingProperties.align="h",iMazingProperties.skinPath=servicePath+"/resources/script/gallery/iMazing/"