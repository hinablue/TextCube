/// Copyright (c) 2004-2011, Needlworks  / Tatter Network Foundation
/// All rights reserved. Licensed under the GPL.
/// See the GNU General Public License for more details. (/documents/LICENSE, /documents/COPYRIGHT)
function TTReader(){this.blogURL=blogURL,this.servicePath=servicePath,this.optionForceLoadImage=!1,this.optionForceNewWindow=!1,this.editingGroupId=0,this.editingFeedId=0,this.selectedGroup=0,this.selectedFeed=0,this.selectedEntry=0,this.selectedGroupObject=null,this.selectedFeedObject=null,this.selectedEntryObject=null,this.unreadOnly=!1,this.starredOnly=!1,this.searchKeyword="",this.isPannelCollapsed=!1,this.resizeStart=0,this.resizeScroll=0,this.resizeHeight=0,this.entriesShown=0,this.entriesTotal=0,this.areEntriesLoading=!1,this.floatingListOffset=0,this.feedUpdating="피드 업데이트 중",this.feedFailure="잘못된 피드",this.feedUpdate="피드 업데이트"}TTReader.prototype.setShownEntries=function(a){this.entriesShown=a,getObject("entriesShown").innerHTML=a},TTReader.prototype.setTotalEntries=function(a){this.entriesTotal=a,getObject("entriesTotal").innerHTML=a},TTReader.prototype.setBlogTitle=function(a){getObject("blogTitle").innerHTML=a},TTReader.prototype.togglePannel=function(a){try{a=STD.event(a),a.returnValue=!1,a.cancelBubble=!0}catch(b){}this.isPannelCollapsed?(getObject("pannel").style.display="block",getObject("toggleButton").className="pannel-show",getObject("toggleButton").innerHTML='<span class="text">'+hide_str+"</span>",setUserSetting("readerPannelVisibility",1)):(getObject("pannel").style.display="none",getObject("toggleButton").className="pannel-hide",getObject("toggleButton").innerHTML='<span class="text">'+show_str+"</span>",setUserSetting("readerPannelVisibility",0)),getObject("floatingList").style.top="0px",this.floatingListOffset=getObject("floatingList").offsetTop,this.isPannelCollapsed=!this.isPannelCollapsed},TTReader.prototype.toggleConfigure=function(){getObject("groupsAndFeeds").style.display=="none"?(getObject("groupsAndFeeds").style.display="block",getObject("configure").style.display="none",getObject("settingLabel").innerHTML='<span class="text">'+configureLabel+"</span>",getObject("settingLabel").parentNode.className="configureText"):(this.isPannelCollapsed&&this.togglePannel(),getObject("groupsAndFeeds").style.display="none",getObject("configure").style.display="block",getObject("settingLabel").innerHTML='<span class="text">'+pannelLabel+"</span>",getObject("settingLabel").parentNode.className="feedListText"),getObject("floatingList").style.top="0px",this.floatingListOffset=getObject("floatingList").offsetTop},TTReader.prototype.startResizing=function(a){a=STD.event(a),a.target.tagName=="DIV"&&!Reader.isPannelCollapsed&&(STD.addEventListener(document),document.addEventListener("selectstart",Reader.returnFalse,!1),document.addEventListener("mousemove",Reader.doResizing,!1),Reader.resizeStart=a.clientY,Reader.resizeScroll=STD.getScrollTop(),Reader.resizeHeight=parseInt(getObject("groupBox").style.height))},TTReader.prototype.returnFalse=function(){return!1},TTReader.prototype.finishResizing=function(){Reader.resizeStart!=0&&(STD.removeEventListener(document),document.removeEventListener("mousemove",Reader.doResizing,!1),document.removeEventListener("selectstart",Reader.returnFalse,!1),setUserSetting("readerPannelHeight",parseInt(getObject("groupBox").style.height)),Reader.resizeStart=0,getObject("floatingList").style.top="0px",this.floatingListOffset=getObject("floatingList").offsetTop)},TTReader.prototype.doResizing=function(a){a=STD.event(a);var b=Reader.resizeHeight+(a.clientY-Reader.resizeStart)+(STD.getScrollTop()-Reader.resizeScroll);b>=100&&(getObject("groupBox").style.height=b+"px",getObject("feedBox").style.height=b+"px")},TTReader.prototype.selectGroup=function(a,b){this.refreshFeedList(b),this.refreshEntryList(b,0),this.refreshEntry(b,0,0),this.selectedGroup=b,getObject("groupList0").className=getObject("groupList0").className.replace(" active-class"," inactive-class"),this.selectedGroupObject!=null&&(this.selectedGroupObject.className=this.selectedGroupObject.className.replace(" active-class"," inactive-class")),this.selectedGroupObject=a.parentNode.parentNode,this.selectedGroupObject.className=this.selectedGroupObject.className.replace(" rollover-class"," active-class"),extraClass=this.selectedGroupObject.className},TTReader.prototype.selectFeed=function(a,b){this.refreshEntryList(this.selectedGroup,b),this.refreshEntry(this.selectedGroup,b,0),this.selectedFeed=b,this.selectedFeedObject!=null&&(this.selectedFeedObject.className=this.selectedFeedObject.className.replace(" active-class"," inactive-class")),this.selectedFeedObject=a,this.selectedFeedObject.className=this.selectedFeedObject.className.replace(" rollover-class"," active-class"),extraClass=this.selectedFeedObject.className},TTReader.prototype.selectEntry=function(a){this.refreshEntry(this.selectedGroup,this.selectedFeed,a),tempClass=document.getElementById("entrytitleList"+this.selectedEntry).className,document.getElementById("entrytitleList"+this.selectedEntry).className=tempClass.replace(/active-class/,"inactive-class"),this.selectedEntry=a,this.selectEntryObject(a)},TTReader.prototype.selectEntryObject=function(a){var b=getObject("entrytitleList"+a);if(b){this.selectedEntryObject=b,this.selectedEntryObject.className="read active-class";var c=getObject("listup");this.floatingListOffset==0&&this.setListPosition(),this.startScroll("listup",getOffsetTop(b)-getOffsetTop(c)-c.offsetHeight/4)}else setTimeout("Reader.selectEntryObject("+a+")",100)},TTReader.prototype.startScroll=function(a,b){var c=getObject(a);typeof b!="undefined"&&(c.scrollTarget=Math.min(Math.max(parseInt(b),0),c.scrollHeight)),c.scrollTop!=c.scrollTarget&&(c.scrollTop+=Math.ceil((c.scrollTarget-c.scrollTop)/5),c.scrollTop+=c.scrollTop>c.scrollTarget?-1:0,c.scrollTop<c.scrollHeight-c.offsetHeight&&setTimeout("Reader.startScroll('"+a+"')",10))},TTReader.prototype.refreshFeedGroup=function(){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/view/group/");a.onSuccess=function(){Reader.selectedGroup=0,Reader.selectedGroupObject=null,getObject("groupBox").innerHTML=this.getText("/response/view")},a.onError=function(){switch(parseInt(this.getText("/response/error"))){default:PM.showErrorMessage(s_unknownError+" (refreshFeedGroup)","center","bottom")}},a.send("group=0&starred="+(this.starredOnly?1:0)+"&keyword="+this.searchKeyword)},TTReader.prototype.refreshFeedList=function(a){var b=new HTTPRequest("POST",this.blogURL+"/owner/reader/view/feed/");b.onSuccess=function(){Reader.selectedFeed=0,Reader.selectedFeedObject=null,getObject("feedBox").innerHTML=this.getText("/response/view")},b.onError=function(){switch(parseInt(this.getText("/response/error"))){default:PM.showErrorMessage(s_unknownError+" (refreshFeedList)","center","bottom")}},b.send("group="+a+"&starred="+(this.starredOnly?1:0)+"&keyword="+this.searchKeyword)},TTReader.prototype.refreshEntryList=function(a,b){var c=new HTTPRequest("POST",this.blogURL+"/owner/reader/view/entries/");c.onSuccess=function(){getObject("listup").innerHTML=this.getText("/response/view"),Reader.selectedEntry=this.getText("/response/firstEntryId");try{Reader.selectedEntryObject=getObject("entrytitleList"+Reader.selectedEntry).parentNode}catch(a){Reader.selectedEntryObject=null}Reader.setShownEntries(parseInt(this.getText("/response/entriesShown"))),Reader.setTotalEntries(parseInt(this.getText("/response/entriesTotal")))},c.onError=function(){switch(parseInt(this.getText("/response/error"))){default:PM.showErrorMessage(s_unknownError+" (refreshEntryList)","center","bottom")}},c.send("group="+(a==undefined?0:a)+"&feed="+(b==undefined?0:b)+"&unread="+(this.unreadOnly?1:0)+"&starred="+(this.starredOnly?1:0)+"&keyword="+this.searchKeyword)},TTReader.prototype.imageLoadingFailed=function(a){a=STD.event(a);var b=a.target;b.nodeType==9&&(b=a.currentTarget),STD.removeEventListener(b),b.removeEventListener("error",Reader.imageLoadingFailed,!1),b.src=Reader.blogURL+"/owner/reader/imageLoader/?url="+encodeURIComponent(b.src)},TTReader.prototype.doPostProcessingOnEntry=function(){if(Reader.optionForceLoadImage){var a=searchChildNodes(getObject("entryBody"),"img");for(var b=0;b<a.length;b++)a[b].getAttribute("trying")!="trying"&&(a[b].setAttribute("trying","trying"),STD.addEventListener(a[b]),a[b].addEventListener("error",Reader.imageLoadingFailed,!1))}if(Reader.optionForceNewWindow){var a=searchChildNodes(getObject("entryBody"),"a");for(var b=0;b<a.length;b++)a[b].target="_blank"}},TTReader.prototype.refreshEntry=function(a,b,c){var d=new HTTPRequest("POST",this.blogURL+"/owner/reader/view/entry/");d.onSuccess=function(){Reader.selectedEntry=this.getText("/response/id"),getObject("blogTitle").innerHTML=this.getText("/response/blog"),getObject("entry").innerHTML=this.getText("/response/view");try{getObject("entrytitleList"+Reader.selectedEntry).className="read active-class"}catch(a){}Reader.setListPosition(!0),Reader.doPostProcessingOnEntry(),window.scrollTo(0,getOffsetTop(getObject("scrollPoint")))},d.onError=function(){switch(parseInt(this.getText("/response/error"))){default:PM.showErrorMessage(s_unknownError+" (refreshEntry)","center","bottom")}},d.send("group="+(a==undefined?0:a)+"&feed="+(b==undefined?0:b)+"&entry="+c+"&unread="+(this.unreadOnly?1:0)+"&starred="+(this.starredOnly?1:0)+"&keyword="+this.searchKeyword)},TTReader.prototype.prevEntry=function(){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/view/entry/next/");a.onSuccess=function(){this.getText("/response/id")!=0?(Reader.selectedEntry=this.getText("/response/id"),Reader.selectEntry(Reader.selectedEntry)):PM.showErrorMessage(s_notFoundPrevPost,"center","bottom")},a.onError=function(){switch(parseInt(this.getText("/response/error"))){default:PM.showErrorMessage(s_unknownError+" (prevEntry)","center","bottom")}},a.send("group="+this.selectedGroup+"&feed="+this.selectedFeed+"&entry="+this.selectedEntry+"&unread="+(this.unreadOnly?1:0)+"&starred="+(this.starredOnly?1:0)+"&keyword="+this.searchKeyword)},TTReader.prototype.nextEntry=function(){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/view/entry/previous/");a.onSuccess=function(){this.getText("/response/id")!=0?(getObject("entrytitleList"+this.getText("/response/id"))==null&&Reader.listScroll(!0),Reader.selectedEntry=this.getText("/response/id"),Reader.selectEntry(Reader.selectedEntry)):PM.showErrorMessage(s_notFoundNextPost,"center","bottom")},a.onError=function(){switch(parseInt(this.getText("/response/error"))){default:PM.showErrorMessage(s_unknownError+" (nextEntry)","center","bottom")}},a.send("group="+this.selectedGroup+"&feed="+this.selectedFeed+"&entry="+this.selectedEntry+"&unread="+(this.unreadOnly?1:0)+"&starred="+(this.starredOnly?1:0)+"&keyword="+this.searchKeyword)},TTReader.prototype.addGroup=function(a){var b=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/group/add/");b.onSuccess=function(){Reader.selectedGroup=0,Reader.selectedGroupObject=null,getObject("groupBox").innerHTML=this.getText("/response/view"),PM.removeRequest(this),PM.showMessage(s_groupAdded,"center","bottom")},b.onError=function(){PM.removeRequest(this);switch(parseInt(this.getText("/response/error"))){case 1:alert(s_enterFeedName);break;case 2:alert(s_groupExists);break;default:PM.showErrorMessage(s_unknownError+" (addGroup)","center","bottom")}},PM.addRequest(b,s_addingGroup),b.send("title="+encodeURIComponent(a)+"&current="+this.selectedGroup)},TTReader.prototype.editGroup=function(a,b){this.editingGroupId=a,getObject("groupList").style.display="none",getObject("groupAdder").style.display="none",getObject("groupEditor").style.display="block",getObject("changeGroupTitle").value=b,getObject("changeGroupTitle").select()},TTReader.prototype.cancelEditGroup=function(){getObject("groupList").style.display="",getObject("groupAdder").style.display="",getObject("groupEditor").style.display="none"},TTReader.prototype.editGroupExecute=function(){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/group/edit/");a.onSuccess=function(){Reader.selectedGroup=0,Reader.selectedGroupObject=null,getObject("groupBox").innerHTML=this.getText("/response/view"),PM.removeRequest(this),PM.showMessage(s_groupModified,"center","bottom")},a.onError=function(){PM.removeRequest(this);switch(parseInt(this.getText("/response/error"))){case 1:alert(s_enterGroupName);break;case 2:break;default:PM.showErrorMessage(s_unknownError+" (editGroupExecute)","center","bottom")}},PM.addRequest(a,s_editingGroup),a.send("id="+this.editingGroupId+"&title="+encodeURIComponent(getObject("changeGroupTitle").value)+"&current="+this.selectedGroup)},TTReader.prototype.deleteGroup=function(){if(!!confirm(s_confirmDelete)){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/group/delete/");a.onSuccess=function(){Reader.selectedGroup=0,Reader.selectedGroupObject=null,getObject("groupBox").innerHTML=this.getText("/response/view"),PM.removeRequest(this),PM.showMessage(s_groupRemoved,"center","bottom")},a.onError=function(){PM.removeRequest(this);switch(parseInt(this.getText("/response/error"))){case 1:alert(s_groupNotFound);break;default:PM.showErrorMessage(s_unknownError+" (deleteGroup)","center","bottom")}},PM.addRequest(a,s_removingGroup),a.send("id="+this.editingGroupId+"&current="+this.selectedGroup)}},TTReader.prototype.addFeed=function(a){var b=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/feed/add/");b.onSuccess=function(){Reader.selectedFeed=0,Reader.selectedFeedObject=null,getObject("feedBox").innerHTML=this.getText("/response/view"),PM.showMessage(s_feedAdded,"center","bottom"),PM.removeRequest(this),Reader.refreshEntryList(this.selectedGroup,this.selectedFeed),Reader.refreshEntry(this.selectedGroup,this.selectedFeed,0)},b.onError=function(){PM.removeRequest(this);switch(parseInt(this.getText("/response/error"))){case 1:alert(s_feedExists);break;case 2:alert(s_conNotConnect);break;case 3:alert(s_feedBroken);break;default:PM.showErrorMessage(s_unknownError+" (addFeed)","center","bottom")}},PM.addRequest(b,s_requestFeed),b.send("group="+this.selectedGroup+"&url="+encodeURIComponent(a))},TTReader.prototype.editFeed=function(a,b){this.editingFeedId=a,getObject("feedList").style.display="none",getObject("feedAdder").style.display="none",getObject("feedEditor").style.display="block",getObject("changeFeedGroup").value=this.selectedGroup,getObject("changeFeedURL").value=b,getObject("changeFeedURL").select()},TTReader.prototype.cancelEditFeed=function(){getObject("feedList").style.display="",getObject("feedAdder").style.display="",getObject("feedEditor").style.display="none"},TTReader.prototype.editFeedExecute=function(){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/feed/edit/");a.onSuccess=function(){Reader.selectedFeed=0,Reader.selectedFeedObject=null,getObject("feedBox").innerHTML=this.getText("/response/view"),PM.removeRequest(this),PM.showMessage(s_feedModified,"center","bottom")},a.onError=function(){PM.removeRequest(this);switch(parseInt(this.getText("/response/error"))){case 1:alert(s_enterFeedName);break;case 2:break;default:PM.showErrorMessage(s_unknownError+" (editFeedExecute)","center","bottom")}},PM.addRequest(a,s_editingFeed),a.send("id="+this.editingFeedId+"&old_group="+this.selectedGroup+"&new_group="+getObject("changeFeedGroup").value+"&url="+encodeURIComponent(getObject("changeFeedURL").value))},TTReader.prototype.deleteFeed=function(){if(!!confirm(s_confirmDelete)){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/feed/delete/");a.onSuccess=function(){Reader.selectedFeed=0,Reader.selectedFeedObject=null,getObject("feedBox").innerHTML=this.getText("/response/view"),PM.removeRequest(this),PM.showMessage(s_feedRemoved,"center","bottom"),Reader.refreshEntryList(this.selectedGroup,this.selectedFeed),Reader.refreshEntry(this.selectedGroup,this.selectedFeed,0)},a.onError=function(){PM.removeRequest(this);switch(parseInt(this.getText("/response/error"))){default:PM.showErrorMessage(s_unknownError+" (deleteFeed)","center","bottom")}},PM.addRequest(a,s_removingFeed),a.send("id="+this.editingFeedId+"&group="+this.selectedGroup)}},TTReader.prototype.saveSetting=function(){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/config/save/");a.onSuccess=function(){getObject("groupsAndFeeds").style.display="block",getObject("configure").style.display="none",getObject("settingLabel").innerHTML='<span class="text">'+configureLabel+"</span>",PM.showMessage(s_saved,"center","bottom")},a.onError=function(){PM.removeRequest(this);switch(parseInt(this.getText("/response/error"))){default:PM.showErrorMessage(s_unknownError+" (saveSetting)","center","bottom")}};var b=document.getElementById("reader-section"),c=b.updateCycle?b.updateCycle.value:"",d=b.feedLife?b.feedLife.value:"",e=b.loadImage?document.getElementById("loadImage1").checked?1:2:"",f=b.allowScript?b.allowScript[0].checked?1:2:"",g=b.newWindow?b.newWindow[0].checked?1:2:"";a.send("updateCycle="+c+"&feedLife="+d+"&loadImage="+e+"&allowScript="+f+"&newWindow="+g),Reader.optionForceLoadImage=document.getElementById("loadImage1")&&document.getElementById("loadImage1").checked?!0:!1,Reader.optionForceNewWindow=b.newWindow[1]&&b.newWindow[1].checked?!0:!1},TTReader.prototype.markAsUnread=function(a){var b=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/mark/unread/");b.presetProperty(getObject("entrytitleList"+a),"className","unread active-class"),b.onSuccess=function(){PM.showMessage(s_markedAsUnread,"center","bottom")},b.send("id="+a)},TTReader.prototype.markAsReadAll=function(){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/mark/allread/");a.onSuccess=function(){Reader.showUnreadOnly(),PM.showMessage(s_markedAsReadAll,"center","bottom")},a.send()},TTReader.prototype.toggleStarred=function(a){typeof a=="undefined"&&(a=this.selectedEntry);if(getObject("star"+a)){if(getObject("star"+a).className.match("-on-")){var b=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/mark/unstar/");b._ttreader=this,b.onSuccess=function(){getObject("star"+a).className=getObject("star"+a).className.replace("-on-","-off-"),getObject("star"+a).innerHTML='<span class="text">'+disscrapedPostText+"</span>"}}else{var b=new HTTPRequest("POST",this.blogURL+"/owner/reader/action/mark/star/");b._ttreader=this,b.onSuccess=function(){getObject("star"+a).className=getObject("star"+a).className.replace("-off-","-on-"),getObject("star"+a).innerHTML='<span class="text">'+scrapedPostText+"</span>"}}b.send("id="+a)}},TTReader.prototype.showUnreadOnly=function(){this.unreadOnly=!0,this.starredOnly=!1,this.searchKeyword="",this.refreshFeedGroup(),this.refreshFeedList(this.selectedGroup),this.refreshEntryList(this.selectedGroup,this.selectedFeed),this.refreshEntry(this.selectedGroup,this.selectedFeed,0)},TTReader.prototype.showStarredOnly=function(){this.unreadOnly=!1,this.searchKeyword="",this.starredOnly?(this.starredOnly=!1,getObject("starredOnlyIndicator").className="scrap-off-icon"):(this.starredOnly=!0,getObject("starredOnlyIndicator").className="scrap-on-icon"),this.refreshFeedGroup(),this.refreshFeedList(0),this.refreshEntryList(0,0),this.refreshEntry(0,0,0)},TTReader.prototype.showSearch=function(){this.starredOnly=!1,this.searchKeyword=getObject("keyword").value,this.refreshFeedGroup(),this.refreshFeedList(0),this.refreshEntryList(0,0),this.refreshEntry(0,0,0)},TTReader.prototype.listScroll=function(a){var b=getObject("listup");if((b.offsetHeight+b.scrollTop>b.scrollHeight-100||a==1)&&this.entriesShown<this.entriesTotal&&!this.areEntriesLoading){this.areEntriesLoading=!0,getObject("feedLoadingIndicator").style.display="block";var c=new HTTPRequest("POST",this.blogURL+"/owner/reader/view/entries/more/");c.onSuccess=function(){PM.removeRequest(this),Reader.areEntriesLoading=!1,Reader.setShownEntries(Reader.entriesShown+parseInt(this.getText("/response/count"))),getObject("feedLoadingIndicator").style.display="none";var a=document.createElement("div");a.innerHTML=this.getText("/response/view"),getObject("additionalFeedContainer").appendChild(a),Reader.entriesShown==Reader.entriesTotal&&(getObject("iconMoreEntries").style.display="none")},c.onError=function(){PM.removeRequest(this),Reader.areEntriesLoading=!1,getObject("feedLoadingIndicator").style.display="none";switch(parseInt(this.getText("/response/error"))){default:PM.showErrorMessage(s_unknownError+" (listScroll)","center","bottom")}},PM.addRequest(c,s_loadingList),c.send("group="+this.selectedGroup+"&feed="+this.selectedFeed+"&unread="+(this.unreadOnly?1:0)+"&starred="+(this.starredOnly?1:0)+"&keyword="+this.searchKeyword+"&loaded="+this.entriesShown)}},TTReader.prototype.setListPosition=function(a){var b=getObject("floatingList");a==!0?(b.style.top="0px",this.setListPosition()):(this.floatingListOffset==0&&(this.floatingListOffset=b.offsetTop),STD.getScrollTop()>this.floatingListOffset-6?b.style.top=STD.getScrollTop()-this.floatingListOffset+6+"px":b.style.top="0px")},TTReader.prototype.openEntryInNewWindow=function(){window.open(getObject("entryPermalink").href)},TTReader.prototype.updateFeed=function(a,b){getObject("iconFeedStatus"+a).className="updating-button button",getObject("iconFeedStatus"+a).innerHTML="<span>"+this.feedUpdating+"</span>";var c=new HTTPRequest("GET",this.blogURL+"/owner/reader/update/"+a);c.onSuccess=function(){getObject("iconFeedStatus"+a).className="update-button button",getObject("iconFeedStatus"+a).innerHTML="<span>"+this.feedUpdate+"</span>",Reader.refreshFeedList(Reader.selectedGroup),Reader.refreshEntryList(Reader.selectedGroup,Reader.selectedFeed),PM.showMessage(b,"center","bottom")},c.onError=function(){getObject("iconFeedStatus"+a).className="failure-button button",getObject("iconFeedStatus"+a).innerHTML="<span>"+this.feedFailure+"</span>";switch(parseInt(this.getText("/response/error"))){case 1:alert(s_xmlBroken);break;case 2:alert(s_conNotConnect);break;case 3:alert(s_feedBroken);break;default:PM.showErrorMessage(s_unknownError+" (updateFeed)","center","bottom")}},c.send()},TTReader.prototype.updateAllFeeds=function(){var a=getObject("hiddenFrame");a.src=this.blogURL+"/owner/reader/update/?__T__="+(new Date).getTime()},TTReader.prototype.importOPMLUpload=function(){document.getElementById("opml-section").submit()},TTReader.prototype.importOPMLURL=function(){var a=new HTTPRequest("POST",this.blogURL+"/owner/reader/opml/import/url/");a.onSuccess=function(){PM.removeRequest(this),Reader.refreshFeedGroup(),Reader.refreshFeedList(0),Reader.refreshEntryList(0,0),Reader.refreshEntry(0,0,0),this.getText("/response/total")==1?alert(this.getText("/response/total")+s_opmlUploadCompleteSingle):alert(this.getText("/response/total")+s_opmlUploadCompleteMulti)},a.onError=function(){PM.removeRequest(this);switch(parseInt(this.getText("/response/error"))){case 1:alert(s_conNotConnect);break;case 2:alert(s_xmlBroken);break;case 3:alert(s_opmlBroken);break;default:PM.showErrorMessage(s_unknownError+" (importOPMLURL)","center","bottom")}},PM.addRequest(a,s_loadingOPML),a.send("url="+encodeURIComponent(getObject("opmlRequestValue").value))},TTReader.prototype.exportOPML=function(){window.location=this.blogURL+"/owner/reader/opml/export/"}