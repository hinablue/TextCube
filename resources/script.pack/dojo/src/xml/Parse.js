/*
	Copyright (c) 2004-2006, The Dojo Foundation
	All Rights Reserved.

	Licensed under the Academic Free License version 2.1 or above OR the
	modified BSD license. For more information on Dojo licensing, see:

		http://dojotoolkit.org/community/licensing.shtml
*/dojo.provide("dojo.xml.Parse"),dojo.require("dojo.dom"),dojo.xml.Parse=function(){function c(a){var c=b(a);if(!c)return"";if(dojo.widget&&dojo.widget.tags[c])return c;var d=c.indexOf(":");if(d>=0)return c;if(c.substr(0,5)=="dojo:")return c;if(dojo.render.html.capable&&dojo.render.html.ie&&a.scopeName!="HTML")return a.scopeName.toLowerCase()+":"+c;if(c.substr(0,4)=="dojo")return"dojo:"+c.substring(4);var e=a.getAttribute("dojoType")||a.getAttribute("dojotype");if(e){e.indexOf(":")<0&&(e="dojo:"+e);return e.toLowerCase()}e=a.getAttributeNS&&a.getAttributeNS(dojo.dom.dojoml,"type");if(e)return"dojo:"+e.toLowerCase();try{e=a.getAttribute("dojo:type")}catch(f){}if(e)return"dojo:"+e.toLowerCase();if(dj_global.djConfig&&!djConfig.ignoreClassNames){var g=a.className||a.getAttribute("class");if(g&&g.indexOf&&g.indexOf("dojo-")!=-1){var h=g.split(" ");for(var i=0,j=h.length;i<j;i++)if(h[i].slice(0,5)=="dojo-")return"dojo:"+h[i].substr(5).toLowerCase()}}return""}function b(a){try{return a.tagName.toLowerCase()}catch(b){return""}}var a=dojo.render.html.capable&&dojo.render.html.ie;this.parseElement=function(d,e,f,g){var h=b(d);if(a&&h.indexOf("/")==0)return null;try{var i=d.getAttribute("parseWidgets");if(i&&i.toLowerCase()=="false")return{}}catch(j){}var k=!0;if(f){var l=c(d);h=l||h,k=Boolean(l)}var m={};m[h]=[];var n=h.indexOf(":");if(n>0){var o=h.substring(0,n);m.ns=o,dojo.ns&&!dojo.ns.allow(o)&&(k=!1)}if(k){var p=this.parseAttributes(d);for(var i in p){if(!m[h][i]||typeof m[h][i]!="array")m[h][i]=[];m[h][i].push(p[i])}m[h].nodeRef=d,m.tagName=h,m.index=g||0}var q=0;for(var r=0;r<d.childNodes.length;r++){var s=d.childNodes.item(r);switch(s.nodeType){case dojo.dom.ELEMENT_NODE:var t=c(s)||b(s);m[t]||(m[t]=[]),m[t].push(this.parseElement(s,!0,f,q)),s.childNodes.length==1&&s.childNodes.item(0).nodeType==dojo.dom.TEXT_NODE&&(m[t][m[t].length-1].value=s.childNodes.item(0).nodeValue),q++;break;case dojo.dom.TEXT_NODE:d.childNodes.length==1&&m[h].push({value:d.childNodes.item(0).nodeValue});break;default:}}return m},this.parseAttributes=function(b){var c={},d=b.attributes,e,f=0;while(e=d[f++]){if(a){if(!e)continue;if(typeof e=="object"&&typeof e.nodeValue=="undefined"||e.nodeValue==null||e.nodeValue=="")continue}var g=e.nodeName.split(":");g=g.length==2?g[1]:e.nodeName,c[g]={value:e.nodeValue}}return c}}